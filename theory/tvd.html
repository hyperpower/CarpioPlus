
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>1.1.1. TVD schemes &#8212; Carpio 0.0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1.1.2. ENO" href="eno.html" />
    <link rel="prev" title="1.1. Convection Scheme" href="convection.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Carpio</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=hyperpower&repo=CarpioPlus&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1.1.1. TVD schemes</a><ul>
<li><a class="reference internal" href="#introduction">1.1.1.1. Introduction</a></li>
<li><a class="reference internal" href="#one-step-time-space-coupled-unsteady-tvd-schemes">1.1.1.2. One-Step Time-Space-Coupled Unsteady TVD Schemes</a></li>
<li><a class="reference internal" href="#semi-discrete-steady-state-tvd-schemes">1.1.1.3. Semi-discrete steady-state TVD schemes</a><ul>
<li><a class="reference internal" href="#first-order-upwind">1.1.1.3.1. First order upwind</a></li>
<li><a class="reference internal" href="#kappa-scheme">1.1.1.3.2. <span class="math notranslate nohighlight">\(\kappa\)</span>-scheme</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="tvd-schemes">
<h1><span class="section-number">1.1.1. </span>TVD schemes<a class="headerlink" href="#tvd-schemes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2><span class="section-number">1.1.1.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The TVD schemes originally developed by Harten. The schemes written here are follow the definition in <a href="#id1"><span class="problematic" id="id2">:cite:`Zhang2015`</span></a></p>
</div>
<div class="section" id="one-step-time-space-coupled-unsteady-tvd-schemes">
<h2><span class="section-number">1.1.1.2. </span>One-Step Time-Space-Coupled Unsteady TVD Schemes<a class="headerlink" href="#one-step-time-space-coupled-unsteady-tvd-schemes" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="semi-discrete-steady-state-tvd-schemes">
<h2><span class="section-number">1.1.1.3. </span>Semi-discrete steady-state TVD schemes<a class="headerlink" href="#semi-discrete-steady-state-tvd-schemes" title="Permalink to this headline">¶</a></h2>
<p>The section describes the method for obtaining the solution of the <strong>steady-state</strong> of the advection equation. Essentially, Eq. <a class="reference internal" href="convection.html#equation-eq-con">(1.1)</a> is equivalent to</p>
<div class="math notranslate nohighlight" id="equation-eq-con-rhs">
<span class="eqno">(1.2)<a class="headerlink" href="#equation-eq-con-rhs" title="Permalink to this equation">¶</a></span>\[\frac{d \phi}{dt} = - \frac{\partial (\mathbf{u} \phi)}{\partial \mathbf{x}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> denotes the dependent variable and <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is the advection velocity. Eq. <a class="reference internal" href="#equation-eq-con-rhs">(1.2)</a> moves flux term on the right-hand side to emphasize the <strong>semi-discrete nature</strong>. Obtianing the steady-state solution of Eq. <a class="reference internal" href="convection.html#equation-eq-con">(1.1)</a> equivalent to solving the <strong>steady</strong> equation</p>
<div class="math notranslate nohighlight" id="equation-eq-con-steady">
<span class="eqno">(1.3)<a class="headerlink" href="#equation-eq-con-steady" title="Permalink to this equation">¶</a></span>\[\frac{\partial (\mathbf{u} \phi)}{\partial \mathbf{x}} = 0\]</div>
<p>This explained why the schemes discuss in this section called <strong>semi-discrete steady-state</strong> TVD schemes. For simplicity, we discuss the Eq. <a class="reference internal" href="#equation-eq-con-steady">(1.3)</a> in one-dimension. Therefore, the eqution becomes</p>
<div class="math notranslate nohighlight" id="equation-eq-con1">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-eq-con1" title="Permalink to this equation">¶</a></span>\[\frac{d (u \phi)}{d \mathbf{x}} = 0\]</div>
<p>Discretization method in the X direction was shown in following figure.</p>
<p>(<a class="reference external" href="../py_matplot/convection_1d.py">Source code</a>, <a class="reference external" href="../py_matplot/convection_1d.png">png</a>, <a class="reference external" href="../py_matplot/convection_1d.hires.png">hires.png</a>, <a class="reference external" href="../py_matplot/convection_1d.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../_images/convection_1d.png" src="../_images/convection_1d.png" />
</div>
<p>The variables are</p>
<table class="colwidths-auto docutils align-center" id="id3">
<caption><span class="caption-number">Table 1.1 </span><span class="caption-text">Summary of Variables.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Sign</p></th>
<th class="head"><p>Note</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(u\)</span></p></td>
<td><p>Velocity is assumed to be positive (<span class="math notranslate nohighlight">\(u&gt;0\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\phi\)</span></p></td>
<td><p>Scalar on center of the control volume</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x_{i-1/2}\)</span></p></td>
<td><p>Left face of the control volume i</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(x_{i+1/2}\)</span></p></td>
<td><p>Right face of the control volume i</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\Delta x_i\)</span></p></td>
<td><p>Size of the control volume <span class="math notranslate nohighlight">\(\Delta x_i = x_{i+1/2}-x_{i-1/2}\)</span></p></td>
</tr>
</tbody>
</table>
<p>The finite volume method is used to obtain the flux-conseravtive form over a control volume <span class="math notranslate nohighlight">\(C_i = [x_{i-1/2}, x_{i-1/2}]\)</span></p>
<div class="math notranslate nohighlight" id="equation-eq-dis-con1">
<span class="eqno">(1.5)<a class="headerlink" href="#equation-eq-dis-con1" title="Permalink to this equation">¶</a></span>\[\frac{ u (\phi_{i+1/2} - \phi_{i-1/2})}{d x} = 0\]</div>
<p>In order to predict the varible value at the cell-face, <span class="math notranslate nohighlight">\(\phi_{i+1/2}\)</span> and <span class="math notranslate nohighlight">\(\phi_{i-1/2}\)</span>. Many methods could be found in the literature.</p>
<div class="section" id="first-order-upwind">
<h3><span class="section-number">1.1.1.3.1. </span>First order upwind<a class="headerlink" href="#first-order-upwind" title="Permalink to this headline">¶</a></h3>
<p>The first order upwind (<strong>FOU</strong>) scheme is straight forward way to get the value on the cell-face. When <span class="math notranslate nohighlight">\(u &gt;0\)</span>, the <span class="math notranslate nohighlight">\(\phi_{i+1/2}\)</span> is simply equal to <span class="math notranslate nohighlight">\(\phi_{i}\)</span>. The <span class="math notranslate nohighlight">\(\phi_{i-1/2}\)</span> is simply equal to <span class="math notranslate nohighlight">\(\phi_{i-1}\)</span>, respectively. The flow information always comes from upwind direction, e.g.</p>
<div class="math notranslate nohighlight">
\[\phi_{i+1/2} = \Biggl \lbrace{\phi_{i} ,\text{ if } u &gt; 0
                              \atop \
                              \phi_{i+1}, \text{ if } u &lt; 0}\]</div>
</div>
<div class="section" id="kappa-scheme">
<h3><span class="section-number">1.1.1.3.2. </span><span class="math notranslate nohighlight">\(\kappa\)</span>-scheme<a class="headerlink" href="#kappa-scheme" title="Permalink to this headline">¶</a></h3>
<p><span class="math notranslate nohighlight">\(\kappa\)</span>-scheme firstly introduecd by Van Leer. The numerical flux of the <span class="math notranslate nohighlight">\(\kappa\)</span>-scheme on uniform 1D grids reads:</p>
<div class="math notranslate nohighlight" id="equation-eq-k-i12">
<span class="eqno">(1.6)<a class="headerlink" href="#equation-eq-k-i12" title="Permalink to this equation">¶</a></span>\[\phi_{i+1/2} = \phi_{i} + (\frac{1 + \kappa}{4} (\phi_{i + 1} - \phi_{i}) + \frac{1 - \kappa}{4} (\phi_{i} - \phi_{i - 1}))\]</div>
<p>Eq. <a class="reference internal" href="#equation-eq-k-i12">(1.6)</a> can be extend to non-uniform 1D grids:</p>
<div class="math notranslate nohighlight">
\[\phi_{i+1/2} = \phi_{i} + \frac{\Delta x_i}{2}(\frac{1 + \kappa}{2} (\frac{d \phi}{d x})_{i+1/2} + \frac{1 - \kappa}{2} (\frac{d \phi}{d x})_{i-1/2} )\]</div>
<p>where,</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\frac{d \phi}{d x})_{i+1/2} &amp;= \frac{\phi_{i+1} - \phi_{i}}{x_{i+1} - x_{i}} \\
(\frac{d \phi}{d x})_{i-1/2} &amp;= \frac{\phi_{i} - \phi_{i-1}}{x_{i} - x_{i-1}} \\
\Delta x_i &amp;= x_{i+1/2} - x_{i-1/2}\end{split}\]</div>
<p>This scheme can be deemed as a combination of a dissipative FOU scheme. The first term on the right hand side of Eq. <a class="reference internal" href="#equation-eq-k-i12">(1.6)</a> is FOU. The rest of the right hand side of Eq. <a class="reference internal" href="#equation-eq-k-i12">(1.6)</a> is <strong>high-order correction</strong> term.</p>
<p>It is well known that some of the classical linear high-order advection schemes can be derived by taking different values of <span class="math notranslate nohighlight">\(\kappa\)</span>, e.g.</p>
<table class="colwidths-auto docutils align-center" id="id4">
<caption><span class="caption-number">Table 1.2 </span><span class="caption-text">Summary of <span class="math notranslate nohighlight">\(\kappa\)</span> scheme</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Value of <span class="math notranslate nohighlight">\(\kappa\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Second Order Upwind (SOU)</p></td>
<td><p>-1</p></td>
</tr>
<tr class="row-odd"><td><p>Fromm</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>CUI</p></td>
<td><p>1/3</p></td>
</tr>
<tr class="row-odd"><td><p>QUICK</p></td>
<td><p>1/2</p></td>
</tr>
<tr class="row-even"><td><p>Center Difference Scheme (CDS)</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2018, Chengsi Zhou.
      
      |
      <a href="../_sources/theory/tvd.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>